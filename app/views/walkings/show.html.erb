<div class="walking-show-page">
  <!-- En-tÃªte avec informations de la balade -->
  <div class="walking-header">
    <div class="walking-header-content">
      <h1 class="walking-title">ğŸ• Balade gÃ©nÃ©rÃ©e</h1>
      <div class="walking-stats">
        <div class="stat-item">
          <span class="stat-icon">ğŸ“</span>
          <span class="stat-value"><%= @walking.circuit.total_distance_km %> km</span>
        </div>
        <div class="stat-item">
          <span class="stat-icon">â±ï¸</span>
          <span class="stat-value"><%= @walking.wanted_duration.to_i %> min</span>
        </div>
        <div class="stat-item">
          <span class="stat-icon"><%= @walking.sociable ? "ğŸŒ" : "ğŸ”’" %></span>
          <span class="stat-value"><%= @walking.sociable ? "Publique" : "PrivÃ©e" %></span>
        </div>
        <div class="stat-item">
          <span class="stat-icon">ğŸ“</span>
          <span class="stat-value"><%= @walking.circuit.poi_count %> points</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Points de passage -->
  <% if @walking.circuit.poi_names.any? %>
    <div class="poi-list">
      <h3>Points de passage :</h3>
      <ul>
        <% @walking.circuit.poi_names.each do |poi_name| %>
          <li><%= poi_name %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <!-- Carte avec itinÃ©raire -->
  <div class="map-container">
    <div style="width: 100%; height: 100%;"
         data-controller="walking-map"
         data-walking-map-api-key-value="<%= ENV['MAPBOX_API_KEY'] %>"
         data-walking-map-coordinates-value="<%= @walking.circuit.coordinates.to_json %>">
    </div>
  </div>

  <!-- Bouton flottant pour dÃ©marrer la navigation -->
  <button class="fab-nav-button"
          data-walking-map-target="startNavButton"
          data-action="click->walking-map#startNavigation"
          title="DÃ©marrer la navigation GPS">
    ğŸ§­
  </button>

  <!-- Actions d'export -->
  <div class="export-actions">
    <h3>Exporter cette balade</h3>
    <div class="export-buttons">
      <%= link_to "ğŸ“¥ TÃ©lÃ©charger GeoJSON",
          walking_path(@walking, format: :json),
          class: "btn btn-secondary btn-sm",
          download: "balade_#{@walking.id}.geojson" %>

      <%= link_to "ğŸ“¥ TÃ©lÃ©charger GPX",
          walking_path(@walking, format: :gpx),
          class: "btn btn-secondary btn-sm",
          download: "balade_#{@walking.id}.gpx" %>
    </div>
  </div>
</div>

<!-- Panel de navigation GPS (masquÃ© par dÃ©faut) -->
<div id="navigation-panel"
     class="navigation-panel"
     data-walking-map-target="navigationPanel">
  <div class="nav-header">
    <div>
      <strong id="nav-title">Navigation</strong>
      <div class="nav-subtitle" id="nav-route-info">Chargement...</div>
    </div>
    <button class="btn btn-danger btn-sm"
            data-action="click->walking-map#stopNavigation">
      âŒ ArrÃªter
    </button>
  </div>

  <div class="nav-instruction">
    <div class="nav-instruction-icon" id="nav-icon">ğŸ§­</div>
    <div class="nav-instruction-text" id="nav-instruction">DÃ©marrage de la navigation...</div>
    <div class="nav-distance" id="nav-distance">Calcul en cours...</div>
  </div>

  <div class="nav-progress">
    <div class="nav-stat">
      <div class="nav-stat-value" id="nav-distance-total">-</div>
      <div class="nav-stat-label">Distance totale</div>
    </div>
    <div class="nav-stat">
      <div class="nav-stat-value" id="nav-duration">-</div>
      <div class="nav-stat-label">Temps restant</div>
    </div>
    <div class="nav-stat">
      <div class="nav-stat-value" id="nav-step">-</div>
      <div class="nav-stat-label">Ã‰tape</div>
    </div>
  </div>

  <div class="nav-actions">
    <button class="btn btn-secondary"
            data-action="click->walking-map#centerOnUser">
      ğŸ¯ Me recentrer
    </button>
  </div>
</div>
